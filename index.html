<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>F16 Dark Mode - Eggapps</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* --- PİLOT PANELİ (HUD) --- */
        #hud {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 280px;
            padding: 15px;
            color: #00ff00;
            background-color: rgba(0, 10, 0, 0.9); /* Biraz daha koyu arka plan */
            background-image: 
                linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 0, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            
            border: 2px solid #00ff00;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(0, 255, 0, 0.15);
            user-select: none;
            z-index: 100;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 255, 0, 0.5);
            padding-bottom: 8px;
            margin-bottom: 15px;
            font-weight: bold;
            letter-spacing: 1px;
            font-size: 14px;
        }

        .rec-dot {
            width: 10px;
            height: 10px;
            background-color: red;
            border-radius: 50%;
            display: inline-block;
            animation: blink 1s infinite;
            margin-right: 5px;
            box-shadow: 0 0 5px red;
        }
        @keyframes blink { 50% { opacity: 0.3; } }

        .score-box {
            border: 1px solid #00ff00;
            background: rgba(0, 60, 0, 0.6);
            padding: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            box-shadow: inset 0 0 10px rgba(0,255,0,0.2);
        }
        .score-label { color: #ffd700; font-size: 13px; font-weight: bold; }
        .score-val { color: #ffd700; font-size: 28px; font-weight: bold; font-family: 'Courier New', Courier, monospace; text-shadow: 0 0 8px #ffd700; }

        .health-label { font-size: 12px; margin-bottom: 5px; display: flex; justify-content: space-between; color: #ccffcc; }
        .health-track {
            width: 100%;
            height: 14px;
            background: #000;
            border-radius: 2px;
            overflow: hidden;
            border: 1px solid #004400;
            margin-bottom: 20px;
        }
        #healthBar {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, #00ff00, #aaff00);
            transition: width 0.2s ease;
            box-shadow: 0 0 10px #00ff00;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .stat-box {
            background: #000;
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 8px;
            text-align: center;
        }
        .stat-label { font-size: 10px; color: #88ff88; margin-bottom: 2px; }
        .stat-value { font-size: 22px; font-weight: bold; font-family: 'Courier New', Courier, monospace; color: #fff; }

        .panel-footer {
            margin-top: 15px;
            font-size: 10px;
            text-align: center;
            color: rgba(0, 255, 0, 0.6);
            border-top: 1px solid rgba(0, 255, 0, 0.2);
            padding-top: 5px;
        }

        /* --- EGGAPPS MARKASI (DAHA PARLAK) --- */
        #brand {
            position: absolute;
            top: 30px;
            right: 40px;
            font-family: 'Arial Black', 'Impact', sans-serif;
            font-size: 48px;
            color: #ffffff;
            text-shadow: 
                3px 3px 0px #003300,
                0 0 25px #00ff00,
                0 0 50px #00ff00; /* Karanlıkta daha çok parlasın */
            pointer-events: none;
            z-index: 100;
            letter-spacing: 2px;
        }

        #damageOverlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 50%, red 150%);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.1s;
            z-index: 50;
        }
        
        #message {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: #ff3333;
            font-family: 'Arial Black', sans-serif;
            font-size: 40px;
            text-transform: uppercase;
            text-shadow: 3px 3px 0 #000;
            display: none;
            z-index: 101;
            background: rgba(0,0,0,0.9);
            padding: 30px;
            border: 4px solid red;
            text-align: center;
        }

        .score-popup {
            position: absolute;
            color: #ffd700;
            font-weight: bold;
            font-size: 30px;
            font-family: 'Arial Black', sans-serif;
            text-shadow: 2px 2px 0 #000, 0 0 15px orange;
            animation: floatUp 1s ease-out forwards;
            pointer-events: none;
            z-index: 102;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-80px) scale(1.2); opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="damageOverlay"></div>
    <div id="message">⚠️ KURTARMA SİSTEMİ DEVREDE</div>
    
    <div id="brand">Eggapps</div>

    <div id="hud">
        <div class="panel-header">
            <span>✈ PİLOT PANELİ v3.1</span>
            <span style="font-size: 10px; color: #ff5555;"><span class="rec-dot"></span>REC</span>
        </div>

        <div class="score-box">
            <span class="score-label">TOPLAM SKOR</span>
            <span class="score-val" id="scoreDisplay">0</span>
        </div>

        <div class="health-label">
            <span>GÖVDE SAĞLIĞI</span>
            <span id="hpText">100%</span>
        </div>
        <div class="health-track">
            <div id="healthBar"></div>
        </div>

        <div class="stats-grid">
            <div class="stat-box">
                <div class="stat-label">HIZ (KM/H)</div>
                <div class="stat-value" id="speedDisplay">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">İRTİFA (M)</div>
                <div class="stat-value" id="altDisplay">0</div>
            </div>
        </div>

        <div class="panel-footer">
            EGGAPPS FLIGHT SYSTEM - DARK EDITION
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // --- 1. SAHNE KURULUMU (KARANLIK MOD) ---
        const scene = new THREE.Scene();
        // Gökyüzü Rengi: Koyu Gri-Mavi (Akşamüstü)
        const darkSkyColor = 0x2c3e50; 
        scene.background = new THREE.Color(darkSkyColor);
        scene.fog = new THREE.Fog(darkSkyColor, 200, 4000); 

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 10000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        // Işıklar (Biraz kısıldı)
        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.5); // 0.7'den 0.5'e
        scene.add(hemiLight);
        
        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8); // 1.2'den 0.8'e
        dirLight.position.set(200, 500, 300);
        dirLight.castShadow = true;
        dirLight.shadow.camera.top = 1000;
        dirLight.shadow.camera.bottom = -1000;
        dirLight.shadow.camera.left = -1000;
        dirLight.shadow.camera.right = 1000;
        scene.add(dirLight);

        // Zemin
        const groundGeo = new THREE.PlaneGeometry(60000, 60000);
        const groundMat = new THREE.MeshPhongMaterial({ color: 0x1a1a1a }); // Daha koyu asfalt
        const ground = new THREE.Mesh(groundGeo, groundMat);
        ground.rotation.x = -Math.PI / 2;
        ground.receiveShadow = true;
        scene.add(ground);

        const grid = new THREE.GridHelper(60000, 600, 0x000000, 0x222222);
        grid.position.y = 0.2;
        scene.add(grid);

        // --- 2. BİNALAR ---
        const buildingBoxes = []; 
        const buildingGeometry = new THREE.BoxGeometry(1, 1, 1);
        // Binalar biraz daha koyu
        const mat1 = new THREE.MeshPhongMaterial({ color: 0x2c3e50 }); 
        const mat2 = new THREE.MeshPhongMaterial({ color: 0x151515 }); 
        const mat3 = new THREE.MeshPhongMaterial({ color: 0x34495e }); 

        const BUILDING_COUNT = 1500; 

        for(let i=0; i<BUILDING_COUNT; i++) {
            const w = 40 + Math.random() * 60;
            const h = 100 + Math.random() * 500;
            const d = 40 + Math.random() * 60;
            
            let mat = mat1;
            const r = Math.random();
            if(r > 0.6) mat = mat2;
            else if(r > 0.3) mat = mat3;

            const building = new THREE.Mesh(buildingGeometry, mat);
            building.scale.set(w, h, d);
            
            let x = (Math.random() - 0.5) * 9000; 
            let z = (Math.random() - 0.5) * 9000;
            
            if(Math.abs(x) < 600 && Math.abs(z) < 3000) x += 1200; 

            building.position.set(x, h/2, z);
            building.castShadow = true;
            building.receiveShadow = true;
            
            building.updateMatrixWorld(); 
            const box = new THREE.Box3().setFromObject(building);
            buildingBoxes.push(box);
            
            scene.add(building);
        }

        // --- 3. PUAN KÜRELERİ (DEVASA & PARLAK) ---
        let score = 0;
        const collectables = [];
        
        const collectableGeo = new THREE.IcosahedronGeometry(6, 2);
        const collectableMat = new THREE.MeshPhongMaterial({ 
            color: 0xFFD700, 
            emissive: 0xFFAA00, // Emissive artırıldı ki karanlıkta parlasın
            emissiveIntensity: 0.8, 
            shininess: 100
        });

        function spawnCollectable() {
            let validPosition = false;
            let tempPos = new THREE.Vector3();
            let scale = 0;
            let attempts = 0;

            while (!validPosition && attempts < 50) {
                attempts++;
                scale = 1.5 + Math.random() * 1.5; 
                tempPos.set(
                    (Math.random() - 0.5) * 8000,
                    50 + Math.random() * 500,
                    (Math.random() - 0.5) * 8000
                );
                const testBox = new THREE.Box3().setFromCenterAndSize(tempPos, new THREE.Vector3(30, 30, 30));
                let intersects = false;
                for(let box of buildingBoxes) {
                    if(testBox.intersectsBox(box)) {
                        intersects = true;
                        break;
                    }
                }
                if(!intersects) validPosition = true;
            }

            if(validPosition) {
                const mesh = new THREE.Mesh(collectableGeo, collectableMat);
                mesh.position.copy(tempPos);
                mesh.scale.set(scale, scale, scale);
                mesh.userData = { points: 100, rotationSpeed: 0.01 + Math.random() * 0.02 };
                scene.add(mesh);
                collectables.push(mesh);
            }
        }

        for(let i=0; i<100; i++) spawnCollectable();
        setInterval(spawnCollectable, 5000);

        function showScorePopup(points) {
            const div = document.createElement('div');
            div.className = 'score-popup';
            div.innerText = "+" + points;
            div.style.left = (window.innerWidth / 2 - 50 + (Math.random()*100)) + 'px';
            div.style.top = (window.innerHeight / 2 - 100) + 'px';
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 1000);
        }

        // --- 4. UÇAK MODELİ ---
        const planeGroup = new THREE.Group();
        
        // Uçak renklerini de hafif koyulaştıralım
        const body = new THREE.Mesh(new THREE.ConeGeometry(1.5, 18, 32), new THREE.MeshStandardMaterial({ color: 0x78909c, roughness: 0.3 }));
        body.rotation.x = -Math.PI / 2;
        body.castShadow = true;
        planeGroup.add(body);
        
        const wings = new THREE.Mesh(new THREE.BoxGeometry(16, 0.4, 8), new THREE.MeshStandardMaterial({ color: 0x546e7a, roughness: 0.3 }));
        wings.position.z = 2;
        wings.castShadow = true;
        planeGroup.add(wings);

        const tail = new THREE.Mesh(new THREE.BoxGeometry(6, 0.4, 4), new THREE.MeshStandardMaterial({ color: 0x546e7a }));
        tail.position.set(0, 0, 7);
        planeGroup.add(tail);

        const vTail = new THREE.Mesh(new THREE.BoxGeometry(0.4, 5, 4), new THREE.MeshStandardMaterial({ color: 0x546e7a }));
        vTail.position.set(0, 2, 7);
        planeGroup.add(vTail);

        const cockpit = new THREE.Mesh(new THREE.SphereGeometry(1.2, 16, 16), new THREE.MeshPhongMaterial({ color: 0x000000, shininess: 150 }));
        cockpit.position.set(0, 1.2, -2);
        cockpit.scale.set(1, 0.6, 2.5);
        planeGroup.add(cockpit);

        // Jet alevi daha parlak olsun
        const flame = new THREE.Mesh(new THREE.ConeGeometry(1, 6, 16), new THREE.MeshBasicMaterial({ color: 0x00ffff }));
        flame.rotation.x = Math.PI / 2;
        flame.position.z = 11;
        flame.visible = false;
        planeGroup.add(flame);

        scene.add(planeGroup);
        planeGroup.position.set(0, 2, 0);
        planeGroup.rotation.order = 'YXZ';

        const playerBox = new THREE.Box3();

        // --- 5. OYUN MANTIĞI ---
        let health = 100;
        let lastDamageTime = 0;
        let speed = 0;
        const keys = { w: false, up: false, down: false, left: false, right: false };
        
        const maxSpeed = 12.0; 
        const acceleration = 0.08;
        const liftSpeed = 3.0;
        const PITCH_SPEED = 0.02; 
        const TURN_SPEED = 0.015;
        const ROLL_MAX = 0.8;
        const PITCH_MAX = 1.0; 

        function resetGame() {
            planeGroup.position.set(0, 2, 0);
            planeGroup.rotation.set(0, 0, 0);
            speed = 0;
            health = 100;
            score = 0;
            document.getElementById('scoreDisplay').innerText = 0;
            keys.w = false; keys.up = false; keys.down = false; keys.left = false; keys.right = false;
            updateHealthUI();
            setTimeout(() => { alert("UÇAK DÜŞTÜ! SİMÜLASYON YENİDEN BAŞLATILIYOR..."); }, 100);
        }

        function takeDamage(amount) {
            health -= amount;
            lastDamageTime = Date.now();
            const overlay = document.getElementById('damageOverlay');
            overlay.style.opacity = 0.8;
            setTimeout(() => overlay.style.opacity = 0, 200);
            updateHealthUI();
            if(health <= 0) { health = 0; resetGame(); }
        }

        function updateHealthUI() {
            const hpText = document.getElementById('hpText');
            const healthBar = document.getElementById('healthBar');
            hpText.innerText = Math.round(health) + "%";
            healthBar.style.width = health + "%";
            
            if(health > 50) {
                healthBar.style.background = "linear-gradient(90deg, #00ff00, #aaff00)";
                hpText.style.color = "#ccffcc";
            } else if(health > 20) {
                healthBar.style.background = "linear-gradient(90deg, #ffa500, #ffcc00)";
                hpText.style.color = "#ffcc00";
            } else {
                healthBar.style.background = "linear-gradient(90deg, #ff0000, #ff5500)";
                hpText.style.color = "#ff5555";
            }
        }

        // --- 6. KLAVYE ---
        document.addEventListener('keydown', (e) => {
            if(e.key === 'w' || e.key === 'W') keys.w = true;
            if(e.key === 'ArrowUp') keys.up = true;
            if(e.key === 'ArrowDown') keys.down = true;
            if(e.key === 'ArrowLeft') keys.left = true;
            if(e.key === 'ArrowRight') keys.right = true;
        });
        document.addEventListener('keyup', (e) => {
            if(e.key === 'w' || e.key === 'W') keys.w = false;
            if(e.key === 'ArrowUp') keys.up = false;
            if(e.key === 'ArrowDown') keys.down = false;
            if(e.key === 'ArrowLeft') keys.left = false;
            if(e.key === 'ArrowRight') keys.right = false;
        });

        // --- 7. ANA DÖNGÜ ---
        function animate() {
            requestAnimationFrame(animate);

            if (health > 0 && health < 100 && Date.now() - lastDamageTime > 10000) {
                health += 0.1;
                if(health > 100) health = 100;
                updateHealthUI();
            }

            if (keys.w) {
                speed += acceleration;
                flame.visible = true;
                flame.scale.setScalar(0.8 + Math.random()*0.4);
            } else {
                flame.visible = false;
                speed -= 0.005; 
            }
            if(speed > maxSpeed) speed = maxSpeed;
            if(speed < 0) speed = 0;

            const oldPosition = planeGroup.position.clone();
            planeGroup.translateZ(-speed);

            for (let i = collectables.length - 1; i >= 0; i--) {
                const item = collectables[i];
                item.rotation.x += 0.02;
                item.rotation.y += 0.02;
                
                const dist = planeGroup.position.distanceTo(item.position);
                const hitRadius = 20 + (item.scale.x * 5); 

                if (dist < hitRadius) {
                    score += item.userData.points;
                    document.getElementById('scoreDisplay').innerText = score;
                    showScorePopup(item.userData.points);
                    scene.remove(item);
                    collectables.splice(i, 1);
                }
            }

            playerBox.setFromObject(planeGroup);
            playerBox.expandByScalar(-1.0); 

            let crash = false;
            if (planeGroup.position.y < 600) { 
                for (let i = 0; i < buildingBoxes.length; i++) {
                    if (playerBox.intersectsBox(buildingBoxes[i])) {
                        crash = true;
                        break;
                    }
                }
            }

            if (crash) {
                takeDamage(20);
                planeGroup.position.copy(oldPosition);
                planeGroup.translateZ(30); 
                planeGroup.position.y += 150;
                planeGroup.rotation.set(0,0,0);
                if (speed < liftSpeed) speed = liftSpeed;
                const msg = document.getElementById('message');
                msg.style.display = 'block';
                setTimeout(() => msg.style.display = 'none', 2000);
            }

            if (speed > 0.5 && health > 0) {
                if(keys.up && planeGroup.rotation.x < PITCH_MAX) planeGroup.rotation.x += PITCH_SPEED;
                if(keys.down && planeGroup.rotation.x > -PITCH_MAX) planeGroup.rotation.x -= PITCH_SPEED;
                if (keys.left) {
                    planeGroup.rotateY(TURN_SPEED);
                    if (planeGroup.rotation.z < ROLL_MAX) planeGroup.rotation.z += 0.03;
                } 
                else if (keys.right) {
                    planeGroup.rotateY(-TURN_SPEED);
                    if (planeGroup.rotation.z > -ROLL_MAX) planeGroup.rotation.z -= 0.03;
                } 
                else {
                    if (planeGroup.rotation.z > 0.005) planeGroup.rotation.z -= 0.015;
                    else if (planeGroup.rotation.z < -0.005) planeGroup.rotation.z += 0.015;
                }
            }

            if (planeGroup.position.y > 2) {
                if (speed < liftSpeed) {
                    const gravityRatio = 1 - (speed / liftSpeed);
                    planeGroup.position.y -= 1.5 * gravityRatio; 
                    if(planeGroup.rotation.x > -0.5) planeGroup.rotation.x -= 0.01;
                }
            } else {
                if (planeGroup.position.y <= 2) {
                    planeGroup.position.y = 2;
                    if (planeGroup.rotation.x < -0.2) { 
                         takeDamage(10);
                         speed = 0; 
                    }
                    if(speed < liftSpeed) {
                        planeGroup.rotation.z *= 0.9;
                        planeGroup.rotation.x *= 0.9;
                    }
                }
            }

            const camOffset = new THREE.Vector3(0, 12, 45); 
            const targetPos = camOffset.applyMatrix4(planeGroup.matrixWorld);
            camera.position.lerp(targetPos, 0.1);
            const lookAtPos = new THREE.Vector3(0, 0, -60).applyMatrix4(planeGroup.matrixWorld);
            camera.lookAt(lookAtPos);

            document.getElementById('speedDisplay').innerText = Math.floor(speed * 120);
            document.getElementById('altDisplay').innerText = Math.floor(planeGroup.position.y - 2);

            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>